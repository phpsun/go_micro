<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1529" height="936" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[# 在线时序图工具： http://webchart.ihuhai.cn
# 工具文档 https://bramp.github.io/js-sequence-diagrams/
Title: Go Server 时序图
Client->API Server: Request * (with token in header)
Note left of API Server: check token
# 通过中间件验证token，验证失败直接返回401
API Server->Client: HTTP 401(Invalid Token)
Note over API Server: 通过Go Routine + GRPC 并发调用后端服务接口（无序）
API Server-->Service 1: Request /service-1
API Server-->Service 2: Request /service-2
API Server-->Service 3: Request /service-3
API Server-->Service ... n: Request /service-n
Note right of Service ... n: 各个Service处理单独业务
Note right of Service ... n: common 是内部模块，而不是内部服务\n·公用数据操作（mysql、redis、pika）\n·公用逻辑运算
Service ... n--> Service 3: Request /service-3
Service 3--> Service ... n: 各Service间也可互相调用
Service 2-->API Server: Response /service-2
Service ... n-->API Server: Response /service-n
Service 1-->API Server: Response /service-1
Service 3-->API Server: Response /service-3
Note over API Server: API Server将业务数据汇总
API Server->Client: Response *]]></source><desc>Go Server 时序图</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="154.015625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="29.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Go Server 时序图</tspan></text></g><g class="actor"><rect x="10" y="48" width="77.609375" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="20" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">Client</tspan></text></g><g class="actor"><rect x="10" y="878.40625" width="77.609375" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="20" y="902.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">Client</tspan></text></g><line x1="48.8046875" x2="48.8046875" y1="86" y2="878.40625" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="318.046875" y="48" width="116.015625" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="328.046875" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="328.046875">API Server</tspan></text></g><g class="actor"><rect x="318.046875" y="878.40625" width="116.015625" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="328.046875" y="902.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="328.046875">API Server</tspan></text></g><line x1="376.0546875" x2="376.0546875" y1="86" y2="878.40625" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="552.2578125" y="48" width="106.421875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="562.2578125" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="562.2578125">Service 1</tspan></text></g><g class="actor"><rect x="552.2578125" y="878.40625" width="106.421875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="562.2578125" y="902.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="562.2578125">Service 1</tspan></text></g><line x1="605.46875" x2="605.46875" y1="86" y2="878.40625" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="678.6796875" y="48" width="106.421875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="688.6796875" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="688.6796875">Service 2</tspan></text></g><g class="actor"><rect x="678.6796875" y="878.40625" width="106.421875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="688.6796875" y="902.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="688.6796875">Service 2</tspan></text></g><line x1="731.890625" x2="731.890625" y1="86" y2="878.40625" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="805.1015625" y="48" width="106.421875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="815.1015625" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="815.1015625">Service 3</tspan></text></g><g class="actor"><rect x="805.1015625" y="878.40625" width="106.421875" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="815.1015625" y="902.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="815.1015625">Service 3</tspan></text></g><line x1="858.3125" x2="858.3125" y1="86" y2="878.40625" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1001.1171875" y="48" width="144.828125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1011.1171875" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1011.1171875">Service ... n</tspan></text></g><g class="actor"><rect x="1001.1171875" y="878.40625" width="144.828125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1011.1171875" y="902.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1011.1171875">Service ... n</tspan></text></g><line x1="1073.53125" x2="1073.53125" y1="86" y2="878.40625" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="signal"><text x="58.8046875" y="116.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="58.8046875">Request * (with token in header)</tspan></text><line x1="48.8046875" x2="376.0546875" y1="124" y2="124" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="240.4296875" y="144" width="115.625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="245.4296875" y="163.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="245.4296875">check token</tspan></text></g><g class="signal"><text x="102.0078125" y="202.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="102.0078125">HTTP 401(Invalid Token)</tspan></text><line x1="376.0546875" x2="48.8046875" y1="210" y2="210" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="156.640625" y="230" width="438.828125" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="161.640625" y="249.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="161.640625">通过Go Routine + GRPC 并发调用后端服务接口（无序）</tspan></text></g><g class="signal"><text x="404.34765625" y="288.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="404.34765625">Request /service-1</tspan></text><line x1="376.0546875" x2="605.46875" y1="296" y2="296" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="467.55859375" y="326.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="467.55859375">Request /service-2</tspan></text><line x1="376.0546875" x2="731.890625" y1="334" y2="334" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="530.76953125" y="364.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="530.76953125">Request /service-3</tspan></text><line x1="376.0546875" x2="858.3125" y1="372" y2="372" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="638.37890625" y="402.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="638.37890625">Request /service-n</tspan></text><line x1="376.0546875" x2="1073.53125" y1="410" y2="410" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="1093.53125" y="430" width="205.21875" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1098.53125" y="449.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1098.53125">各个Service处理单独业务</tspan></text></g><g class="note"><rect x="1093.53125" y="478" width="314.03125" height="66.40625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1098.53125" y="497.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1098.53125">common 是内部模块，而不是内部服务</tspan><tspan dy="1.2em" x="1098.53125">·公用数据操作（mysql、redis、pika）</tspan><tspan dy="1.2em" x="1098.53125">·公用逻辑运算</tspan></text></g><g class="signal"><text x="879.5078125" y="574.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="879.5078125">Request /service-3</tspan></text><line x1="1073.53125" x2="858.3125" y1="582.40625" y2="582.40625" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="868.3125" y="612.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="868.3125">各Service间也可互相调用</tspan></text><line x1="858.3125" x2="1073.53125" y1="620.40625" y2="620.40625" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="462.75390625" y="650.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="462.75390625">Response /service-2</tspan></text><line x1="731.890625" x2="376.0546875" y1="658.40625" y2="658.40625" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="633.57421875" y="688.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="633.57421875">Response /service-n</tspan></text><line x1="1073.53125" x2="376.0546875" y1="696.40625" y2="696.40625" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="399.54296875" y="726.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="399.54296875">Response /service-1</tspan></text><line x1="605.46875" x2="376.0546875" y1="734.40625" y2="734.40625" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="525.96484375" y="764.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="525.96484375">Response /service-3</tspan></text><line x1="858.3125" x2="376.0546875" y1="772.40625" y2="772.40625" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="267.046875" y="792.40625" width="218.015625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="272.046875" y="811.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="272.046875">API Server将业务数据汇总</tspan></text></g><g class="signal"><text x="164.421875" y="850.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="164.421875">Response *</tspan></text><line x1="376.0546875" x2="48.8046875" y1="858.40625" y2="858.40625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>